generator client {
  provider = "prisma-client-js"
}

generator zod {
  provider                         = "zod-prisma-types"
  output                           = "../generated/types/src"
  addInputTypeValidation           = "false"
  createInputTypes                 = "false"
  createModelTypes                 = "true"
  createOptionalDefaultValuesTypes = "false"
  createRelationValuesTypes        = "true"
  useMultipleFiles                 = "true"
  writeBarrelFiles                 = "true"
}

datasource db {
  provider = "postgresql"
}

model Author {
  id   String @id @default(uuid())
  name String @unique
  created_at              DateTime            @default(now())
  updated_at              DateTime            @updatedAt @default(now())

  work Work[]
  @@map("author")
}

model Work{
  id          String        @id @default(uuid())
  title        String
  author_id   String
  author      Author        @relation(fields: [author_id], references: [id])
  year        Int
  created_at              DateTime            @default(now())
  updated_at              DateTime            @updatedAt @default(now())

  section Section[]
  @@map("work")
}

model Section {
  id          String        @id @default(uuid())
  section_number        String?
  section_order Int?
  title        String?
  work_id     String
  work        Work          @relation(fields: [work_id], references: [id])
  created_at              DateTime            @default(now())
  updated_at              DateTime            @updatedAt @default(now())

  section_text SectionText[]
  @@map("section")
}


model SectionText {
  id        String    @id @default(uuid())
  section_id String
  section Section @relation(fields: [section_id], references: [id])

  text_type TextType
  language  String
  content   String
  Example   Example[]
  created_at              DateTime            @default(now())
  updated_at              DateTime            @updatedAt @default(now())

  @@map("section_text")
}

model Annotation {
  id               String             @id @default(uuid())
  motivation       MotivationEnum
  // text_id          String
  // text             Text               @relation(fields: [text_id], references: [id])
  annotationBody   AnnotationBody[]
  annotationTarget AnnotationTarget[]
  created_at              DateTime            @default(now())
  updated_at              DateTime            @updatedAt @default(now())

  @@map("annotation")
}

model AnnotationBody {
  id            String          @id @default(uuid())
  value         Json
  annotation_id String
  source_type   AnnotationType?
  source_id     String?
  annotation    Annotation      @relation(fields: [annotation_id], references: [id], onDelete: Cascade)
  created_at              DateTime            @default(now())
  updated_at              DateTime            @updatedAt @default(now())

  @@map("annotation_body")
}

model AnnotationTarget {
  id            String         @id @default(uuid())
  value         Json
  annotation_id String
  source_type   AnnotationType
  source_id     String
  annotation    Annotation     @relation(fields: [annotation_id], references: [id], onDelete: Cascade)
  created_at              DateTime            @default(now())
  updated_at              DateTime            @updatedAt @default(now())

  @@map("annotation_target")
}

model Example {
  id              String      @id @default(uuid())
  name            String
  register_id     String
  section_text_id String
  register        Register    @relation(fields: [register_id], references: [id])
  section_text     SectionText @relation(fields: [section_text_id], references: [id])
  created_at              DateTime            @default(now())
  updated_at              DateTime            @updatedAt @default(now())
  lemmas Lemma[] @relation("example_lemma")

  @@map("example")
}

model Register {
  id       String    @id @default(uuid())
  name     String    @unique
  examples Example[]
  created_at              DateTime            @default(now())
  updated_at              DateTime            @updatedAt @default(now())

  @@map("register")
}

model Speech {
  id   String @id @default(uuid())
  name String @unique
  lemma Lemma[]
  created_at              DateTime            @default(now())
  updated_at              DateTime            @updatedAt @default(now())

  @@map("speech")
}

model Lemma {
  id          String   @id @default(uuid())
  word        String   @unique
  link        String
  grammatical Boolean? @default(false)
  comparative Boolean? @default(false)
  superlative Boolean? @default(false)
  participle  Boolean? @default(false)
  speech_id   String
  speech      Speech   @relation(fields: [speech_id], references: [id])
  created_at              DateTime            @default(now())
  updated_at              DateTime            @updatedAt @default(now())
  examples Example[] @relation("example_lemma")

  @@map("lemma")
}

enum TextType {
  SOURCE
  TRANSLATION
}

enum MotivationEnum {
  classifying
  tagging
}

enum AnnotationType {
  text_translation
  annotation
  example
  lemma
}
